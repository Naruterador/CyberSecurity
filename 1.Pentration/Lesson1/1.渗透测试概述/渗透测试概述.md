## 什么是渗透测试
- 滲透测试是通过模拟恶意黑客的攻击方法，来评估计算机网络系统安全的一种安全测试与评估方法。通过实施渗透测试，可以发现一个主机中潜在却未被披露的安全性问题。然后，用户可以根据测试结果对系统中的不足和安全弱点进行加固及改善，从而使用户的系统变得更加安全，减少其风险。当用户实施渗透测试时，可以使用黑盒测试、白盒测试和灰盒测试3种方式。

## 渗透测试的起源与定义
- 各国军队每年都会组织一些军事演习来锻炼军队的攻防战术与作战能力。在信息科技的发源地——美国的军事演习中，将美军称为“蓝军”，将假想敌称为 “红军”，而这种军事演习的方式也在20 世纪 90 年代时，由美国军方与国家安全局引人到对信息网络与信息安全基础设施的实际攻防测试过程中。由一群受过职业训练的安全专家作为“红队”（Red Team)，对接受测试的防御方 “蓝队”(Blue Team）进行攻击，以实战的方式来检验目标系统安全防御体系与安全响应计划的有效性。为此，美军和园家安全局等情报部门专门组建了一些职业化的“红队”（也称为 Tiger Team)，比如著名的美国国家安全局 Red Cell 团队、美国海军计算机网络红队等。
- 这种通过实际的攻击进行安全测试与评估的方法就是渗透测试 (Penetration Testing,Pentest)。在20世纪90年代后期逐步开始从军队与情报部门拓展到安全业界。一些对安全性需求很高的企业开始采纳这种方式来对他们自己的业务网络与系统进行测试，而渗透测试也逐渐发展为一种由安全公司所提供的专业化安全评估服务。-
- 简而言之，渗透测试就是一种通过模拟恶意攻击者的技术与方法，挫败目标系统安全控制措施，取得访问控制权，并发现具备业务影响后果安全隐患的一种安全测试与评估方式。
- 滲透测试过程一般需要对目标系统进行主动探测分析，以发现潜在的系统漏洞，包括不恰当的系统配置，已知或未知的软硬件漏洞，以及在安全计划与响应过程中的操作性弱点等。而这一过程需要以攻击者的角度进行实施，通常涉及对大量发现安全漏洞的主动渗透与人侵攻击。渗透测试中发现的所有安全问题，它们所带来的业务影响后果评估，以及如何避免这些问题的技术解决方案，将在最终报告中呈现给目标系统的拥有者，帮助他们修补并提升系统的安全性。
- 渗透测试目前已经成为系统整体安全评估中的一个组件部分，例如银行支付行业数据安全标准(PCI DSS)等都将渗透测试作为必须进行的安全测试形式。
- 作为一种对抗性和定制要求都非常高的服务，渗透测试的完成质量依赖于实施人员即渗透测试者（Penetration Tester, Pentester）的技术能力、专业素养以及团队协作能力。提供渗透测试服务的安全公司或组织都需要由职业化渗透测试者组成的专业团队，这些滲透测试者一般被称为渗透测试工程师。

## 渗透测试分类
### 黑盒测试
- 黑盒测试（Black-box Testing）也称为外部测试 (External Testing)。采用这种方式时，滲透测试者将从一个远程网络位置来评估目标网络基础设施，并没有任何目标网络内部拓扑等相关信息。他们完全模拟真实网络环境中的外部攻击者，采用流行的攻击技术与工具，有组织、有步聚地对目标组织进行逐步渗透和入侵，揭示目标网络中一些已知或末知的安全漏洞，并评估这些漏洞能否被利用，以荻取控制权或者操作业务造成资产损失等。黑盒测试的缺点是测试较为费时和费力，同时需要渗透测试者具备较高的技术能力。而优点在于，这种类型的测试更有利于挖掘出系统潜在的漏洞，以及脆弱环节和薄弱点等。
### 白盒测试
- 白盒测试（White-box Testing）也称为内部测试 (Internal Testing）。进行白盒测试的渗透测试者可以了解到关于目标环境的所有内部和底层信息。这可以让滲透测试人员以最小的代价发现和验证系统中最严重的漏洞。白盒测试的实施流程与黑盒测试类似，不同之处在于无须进行目标定位和情报收集。渗透测试人员可以通过正常渠道从被测试机构取得各种资料，如网络拓扑、员工资料甚至网站程序的代码片段等，也可以和单位其他员工进行面对面沟通。白盒测试的缺点是无法有效地测试客户组织的应急响应程序，也无法判断出他们的安全防护计划对特定攻击的检测效率。这种测试的优点是发现和解决安全漏洞所花费的时间和代价要比黑盒测试少很多。
### 灰盒测试
- 灰盒测试（Grey-box Testing）是白盒测试和黑盒测试基本类型的组合，它可以提供对目标系统更加深入和全面的安全审查。组合之后的好处就是能够同时发挥这两种滲透测试方法的优势。在采用灰盒测试方法的外部渗透攻击场景中，渗透测试者也类似地需要从外部逐步渗透进目标网络，但他所拥有的目标网络底层拓扑与架构将有助于更好地选择攻击途径与方法，从而达到更好的渗透测试效果。

## 渗透测试方法与流程
- 目前，安全业界比较流行的开源渗透测试方法体系标准包括以下几个:
  - 安全测试方法学开源手册:
    - 由ISECOM 安全与公开方法学研究所制定，最新版本为2010年发布的v3.0。安全测试方法学开源手册 （OSSTMM）提供物理安全、人类心理学、数据网络、无线通信媒介和电讯通信这五类渠道非常细致的测试用例，同时给出评估安全测试结果的指标标准。OSSTMM 的特色在于非常注重技术的细节，这使其成为一个具有很好可操作性的方法指南。
  - NIST SP 800-42 网络安全测试指南
    - 美国国家标准与技术研究院(NIST）在SP 800-42 网络安全测试指南中讨论了渗透测试流程与方法，虽然不及 OSSTMM 全面，但是它更可能被管理部门所接受。
  - OWASP十大Web 应用安全威胁项目
    - 针对目前最普遍的 Web 应用层，为安全测试人员和开发者提供了如何识别与避免这些安全威胁的指南。OWASP十大web 应用安全威胁项目 (OWASP Top Ten）只关注具有最高风险的 Web 领域，而不是一个普适性的渗透测试方法指南。
  - Web 安全威胁分类标准
    - 与OWASP Top Ten 类似，web 应用安全威胁分类标准 (WASC-IC） 全面地给出目前Web 应用领域中的漏洞、攻击与防范措施视图。
  - PTES 渗透测试执行标准
    - 2010 年最新发起的渗透测试过程规范标准项目，核心理念是通过建立起进行滲透测试所要求的基本准则基线，来定义一次真正的渗透测试过程，并得到安全业界的广泛认同。通过深人了解这些开放的渗透测试方法标准，将有助于你对渗透测试建立起一个整体的知识与技能体系，所有这些方法标准背后的基本想法就是你的渗透测试过程应该按步骤实施，从而确保更加精确地评价一个系统的安全性。我们无法在这里细致地介绍每一个标准的细节，只是简要地介绍最新的 PTES 标准中定义的渗透测试过程环节。当你更加深人地了解渗透测试技术之后，可以更进一步去了解这些渗透测试方法体系，并在实际的渗透测试实践中加以应用。

## 渗透测试流程

- 当用户对渗透测试的概念了解清楚后，就可以开始对一个目标实施渗透了。渗透流程如下： 
  - 1.前期交互
    -  在进行渗透测试之前，渗透测试者需要与滲透测试目标、渗透测试范围、滲透测试方式、服务合同等细节进行商议，以达成一致协议。该阶段是之后进行渗透测试的基础和关键。
  - 2.信息收集
    - 在确定了渗透测试目标及范围以后，接下来就进入信息收集阶段。在这个阶段，渗透测试者需要使用各种公开的资源尽可能地获取与测试目标相关的信息。此时，滲透测试者可以借助互联网进行信息收集，如官方网站、论坛、博客等。同时，也可以借助各大搜索引擎来获取相关信息，如 Baidu 和 Google 等。还可以借助 Kali Linux 中的一些工具来对DNS 信息、注册人信息、服务信息、WAF 信息等进行收集。这个阶段收集的信息越充分，对之后的渗透测试越有利，渗透测试的成功率也会大大提高。
  - 3.漏洞扫描
    - 当渗透测试者收集到足够多的信息之后，就可以对目标实施漏洞扫描了。在该阶段，滲透测试者通过网络对目标系统进行探测，向目标系统发送数据，并将反馈数据与自带的-漏洞特征库进行匹配，进而列举出目标系统上存在的安全漏洞。
  - 4.漏洞利用
    - 当渗透测试者探测到目标主机存在漏洞之后，就可以通过己有的漏洞利用程序对目标系统进行渗透。但是，在一般情况下，滲透测试者都需要考虑到目标系统的环境对漏洞利用程序进行修改和额外的研究，否则它无法正常工作。同时，在该阶段也要考虑到对目标系统的安全机制的逃逸，从而避免让目标系统发现。
  - 5.编写报告
    - 在完成滲透测试之后，需要对这次渗透测试编写测试报告。在编写的报告中需要包括获取到的各种有价值的信息，以及探测和挖掘出来的安全漏洞、成功攻击过程及对业务造成的影响和后果分析等。同时，还要明确地写出目标系统中存在的漏洞及漏洞的修补方法。这样，目标用户就可以根据渗透测试者提供的报告修补这些漏洞和风险，以防止被黑客攻击。
